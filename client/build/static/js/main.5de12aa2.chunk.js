(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{101:function(e,t,n){},102:function(e,t,n){},126:function(e,t,n){},128:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=128},158:function(e,t,n){"use strict";n.r(t);var c,r,a,o,i,s=n(0),l=n(10),u=n.n(l),d=(n(101),n(102),n(2)),f=n(14),p=n(174),b=n(176),g=n(83),j=n.n(g),v=n(4),m=function(){var e=Object(d.f)(),t=Object(s.useState)(""),n=Object(f.a)(t,2),c=n[0],r=n[1];return Object(s.useEffect)((function(){j.a.get("/api/call").then((function(e){console.log(e.data),r(e.data)})).catch((function(e){console.log(e.response)}))}),[]),Object(v.jsxs)("div",{style:{margin:"0px 0px 0px 30px"},children:[Object(v.jsx)("h1",{style:{textAlign:"left"},children:"Video Conference App"}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)(p.a,{children:"Your meeting ID"}),Object(v.jsx)("div",{style:{padding:"10px 10px",margin:"0px 20px",backgroundColor:"rgb(0,0,0,0.1)"},children:c})]}),Object(v.jsx)("div",{style:{display:"flex"},children:Object(v.jsx)(b.a,{variant:"contained",style:{backgroundColor:"rgb(0, 131, 255)",color:"white",margin:"20px 100px"},onClick:function(){e("/".concat(c))},children:"JOIN MEETING"})})]})},x=n(6),h=n.n(x),k=n(17),O=(n(126),n(178)),w=n(48),y=n(179),C=n(180),S=n(86),T=n.n(S),_=n(87),I=n.n(_),D=n(88),E=n.n(D),L=n(89),R=n.n(L),N=(n(127),n(85)),M=n.n(N),U=Object(O.a)({root:{backgroundColor:"#141414"},grid:{height:"100vh",display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center"},controls:{backgroundColor:"white",height:"70px",width:"100vw",position:"absolute",bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},loader:{height:"120px",width:"100vw",position:"absolute",bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},join:{textTransform:"none",fontSize:"20px",padding:"4px 20px",marginRight:"15px",fontWeight:600,transition:"0.3s ease-in-out","&:hover":{backgroundColor:"rgb(0, 101, 255)",color:"white"}}}),z={audio:!0,video:{width:1280,height:720}},A={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"}]},F={},B=function(){var e=U(),t=Object(s.useState)(-1),n=Object(f.a)(t,2),l=n[0],u=n[1],d=Object(s.useState)(!0),p=Object(f.a)(d,2),g=p[0],j=p[1],m=Object(s.useState)(!1),x=Object(f.a)(m,2),O=x[0],S=x[1],_=Object(s.useState)(0),D=Object(f.a)(_,2),L=(D[0],D[1]),N=Object(s.useState)(!0),B=Object(f.a)(N,2),J=B[0],P=B[1],W=Object(s.useState)(!0),q=Object(f.a)(W,2),G=q[0],V=q[1],Y=Object(w.b)().enqueueSnackbar,H=function(e,t){Y(e,{variant:t})};Object(s.useEffect)(Object(k.a)(h.a.mark((function e(){var t,n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.location.href,i=t.split("/")[t.split("/").length-1],r=document.getElementById("video-grid"),(n=document.createElement("video")).muted=!0,e.prev=5,e.next=8,navigator.mediaDevices.getUserMedia(z);case 8:c=e.sent,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(5),alert("Could not get user media. Check your media devices or Refresh"),console.error("Could not get user media",e.t0);case 15:a=c,X(r,n,c,"my-video"),j(!1),setTimeout((function(){S(!0)}),[1e3]);case 19:case"end":return e.stop()}}),e,null,[[5,11]])}))),[]);var K=function(){var e=Object(k.a)(h.a.mark((function e(t){var n,c,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P((function(e){return!e})),console.log(a.getTracks()),"live"!==(n=a.getTracks().find((function(e){return"audio"===e.kind}))).readyState){e.next=8;break}n.enabled=!n.enabled,setTimeout((function(){n.stop()}),500),e.next=20;break;case 8:return e.prev=8,e.next=11,navigator.mediaDevices.getUserMedia({audio:!0});case 11:if(c=e.sent,a.removeTrack(n),a.addTrack(c.getTracks()[0]),t)for(r in F)console.log(F[r].getSenders()),F[r].getSenders()[0].replaceTrack(c.getTracks()[0]);e.next=20;break;case 17:e.prev=17,e.t0=e.catch(8),console.error("Could not get user media",e.t0);case 20:case"end":return e.stop()}}),e,null,[[8,17]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(k.a)(h.a.mark((function e(t){var n,c,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V((function(e){return!e})),console.log(a.getTracks()),"live"!==(n=a.getTracks().find((function(e){return"video"===e.kind}))).readyState){e.next=8;break}n.enabled=!n.enabled,setTimeout((function(){n.stop()}),500),e.next=20;break;case 8:return e.prev=8,e.next=11,navigator.mediaDevices.getUserMedia({video:{width:1280,height:720}});case 11:if(c=e.sent,a.removeTrack(n),a.addTrack(c.getTracks()[0]),t)for(r in F)console.log(F[r].getSenders()),F[r].getSenders()[1].replaceTrack(c.getTracks()[0]);e.next=20;break;case 17:e.prev=17,e.t0=e.catch(8),console.error("Could not get user media",e.t0);case 20:case"end":return e.stop()}}),e,null,[[8,17]])})));return function(t){return e.apply(this,arguments)}}(),X=function(e,t,n,c){t.srcObject=n,t.setAttribute("id",c),t.classList.add("video"),t.addEventListener("loadedmetadata",(function(){t.play()})),e.append(t)};function Z(e){a.getTracks().forEach((function(t){e.addTrack(t,a)}))}function $(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(k.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createOffer();case 3:r=e.sent,t.setLocalDescription(r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:o.emit("webrtc_offer",{type:"webrtc_offer",sdp:r,roomId:i},n,c);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(k.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createAnswer();case 3:r=e.sent,t.setLocalDescription(r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:o.emit("webrtc_answer",{type:"webrtc_answer",sdp:r,roomId:i},n,c);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function ce(e,t){if(console.log(e),"video"===e.track.kind){var n=document.createElement("video");X(r,n,e.streams[0],t)}}function re(e,t){e.candidate&&o.emit("webrtc_ice_candidate",{roomId:i,label:e.candidate.sdpMLineIndex,candidate:e.candidate.candidate},c)}return Object(v.jsxs)("div",{className:e.root,children:[Object(v.jsx)("div",{id:"video-grid",className:e.grid,children:g?Object(v.jsx)(y.a,{}):null}),O?Object(v.jsxs)("div",{className:e.controls,children:[-1===l?Object(v.jsx)(b.a,{variant:"outlined",onClick:function(){(o=M.a.connect("/")).on("connected",function(){var e=Object(k.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(1),c=t,console.log("User Id : "+c),o.emit("join-room",i,c),o.on("room_created",Object(k.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket event callback: room_created");case 1:case"end":return e.stop()}}),e)})))),o.on("room_joined",Object(k.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket event callback: room_joined"),o.emit("start_call",i,c);case 2:case"end":return e.stop()}}),e)})))),o.on("start_call",function(){var e=Object(k.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: start_call from "+t),Z(n=new RTCPeerConnection(A)),F[t]=n,H(t+" joined","success"),n.ontrack=function(e){ce(e,t)},n.onicecandidate=function(e){re(e)},e.next=9,$(n,t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o.on("webrtc_offer",function(){var e=Object(k.a)(h.a.mark((function e(t,n){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: webrtc_offer from "+n),Z(c=new RTCPeerConnection(A)),F[n]=c,c.ontrack=function(e){ce(e,n)},c.onicecandidate=function(e){re(e)},c.setRemoteDescription(new RTCSessionDescription(t)),e.next=9,te(c,n);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o.on("webrtc_answer",(function(e,t){console.log("Socket event callback: webrtc_answer from "+t),F[t].setRemoteDescription(new RTCSessionDescription(e))})),o.on("webrtc_ice_candidate",(function(e,t){console.log("Socket event callback: webrtc_ice_candidate from "+t);var n=new RTCIceCandidate({sdpMLineIndex:e.label,candidate:e.candidate});F[t].addIceCandidate(n)})),o.on("user-disconnected",(function(e){H(e+" left","error"),F[e]&&F[e].close();var t=document.getElementById(e);t&&(t.remove(),L((function(e){return e-1})))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u(0)},className:e.join,children:"Join"}):0===l?Object(v.jsx)(y.a,{}):null,Object(v.jsx)(C.a,{style:{color:J?"grey":"red",marginRight:"10px"},onClick:function(){K(1===l)},children:J?Object(v.jsx)(T.a,{style:{fontSize:"30px"}}):Object(v.jsx)(I.a,{style:{fontSize:"30px"}})}),Object(v.jsx)(C.a,{style:{color:G?"grey":"red",marginLeft:"10px"},onClick:function(){Q(1===l)},children:G?Object(v.jsx)(E.a,{style:{fontSize:"30px"}}):Object(v.jsx)(R.a,{style:{fontSize:"30px"}})})]}):null]})},J=[{path:"/",children:[{path:"/",element:Object(v.jsx)(m,{})},{path:"/:roomId",element:Object(v.jsx)(B,{})},{path:"*",element:Object(v.jsx)(d.a,{to:"/",replace:!0})}]}];var P=function(){var e=Object(d.h)(J);return Object(v.jsx)("div",{className:"App",children:Object(v.jsx)(w.a,{maxSnack:3,children:e})})},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,182)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),a(e),o(e)}))},q=n(34);u.a.render(Object(v.jsx)(q.a,{children:Object(v.jsx)(P,{})}),document.getElementById("root")),W()}},[[158,1,2]]]);
//# sourceMappingURL=main.5de12aa2.chunk.js.map