(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{101:function(e,t,n){},102:function(e,t,n){},126:function(e,t,n){},128:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=128},158:function(e,t,n){"use strict";n.r(t);var r,c,a,o,i,s=n(0),l=n(9),d=n.n(l),u=(n(101),n(102),n(2)),f=n(21),p=n(174),b=n(176),v=n(83),g=n.n(v),m=n(4),j=function(){var e=Object(u.f)(),t=Object(s.useState)(""),n=Object(f.a)(t,2),r=n[0],c=n[1];return Object(s.useEffect)((function(){g.a.get("/api/call").then((function(e){console.log(e.data),c(e.data)})).catch((function(e){console.log(e.response)}))}),[]),Object(m.jsxs)("div",{style:{margin:"0px 0px 0px 30px"},children:[Object(m.jsx)("h1",{style:{textAlign:"left"},children:"Video Conference App"}),Object(m.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(m.jsx)(p.a,{children:"Your meeting ID"}),Object(m.jsx)("div",{style:{padding:"10px 10px",margin:"0px 20px",backgroundColor:"rgb(0,0,0,0.1)"},children:r})]}),Object(m.jsx)("div",{style:{display:"flex"},children:Object(m.jsx)(b.a,{variant:"contained",style:{backgroundColor:"rgb(0, 131, 255)",color:"white",margin:"20px 100px"},onClick:function(){e("/".concat(r))},children:"JOIN MEETING"})})]})},x=n(6),h=n.n(x),k=n(23),w=(n(126),n(178)),O=n(48),y=n(179),T=n(86),C=n.n(T),S=n(87),_=n.n(S),I=n(88),E=n.n(I),D=n(89),L=n.n(D),R=(n(127),n(85)),N=n.n(R),M=Object(w.a)({root:{backgroundColor:"#141414"},grid:{height:"100vh",display:"flex",flexWrap:"wrap"},controls:{backgroundColor:"white",height:"70px",width:"100vw",position:"absolute",bottom:0,display:"flex",justifyContent:"center",alignItems:"center"}}),A={audio:!0,video:{width:1280,height:720}},U={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"}]},F={},z=function(){var e=M(),t=Object(s.useState)(0),n=Object(f.a)(t,2),l=n[0],d=n[1],u=Object(s.useState)(!0),p=Object(f.a)(u,2),b=p[0],v=p[1],g=Object(s.useState)(!0),j=Object(f.a)(g,2),x=j[0],w=j[1],T=Object(s.useRef)(null),S=Object(s.useRef)(null),I=Object(O.b)().enqueueSnackbar,D=function(e,t){I(e,{variant:t})};Object(s.useEffect)((function(){o=N.a.connect("/");var e=window.location.href;i=e.split("/")[e.split("/").length-1],c=document.getElementById("video-grid");var t=document.createElement("video");t.muted=!0,o.on("connected",function(){var e=Object(k.a)(h.a.mark((function e(n){var s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n,console.log("User Id : "+r),e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia(A);case 5:s=e.sent,e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),alert("Could not get user media. Check your media devices or Refresh"),console.error("Could not get user media",e.t0);case 12:a=s,R(c,t,s,r),o.emit("join-room",i,r),T.current.addEventListener("click",Object(k.a)(h.a.mark((function e(){var t,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v((function(e){return!e})),console.log(a.getTracks()),"live"!==(t=a.getTracks().find((function(e){return"audio"===e.kind}))).readyState){e.next=8;break}t.enabled=!t.enabled,setTimeout((function(){t.stop()}),500),e.next=20;break;case 8:return e.prev=8,e.next=11,navigator.mediaDevices.getUserMedia({audio:!0});case 11:for(r in n=e.sent,a.removeTrack(t),a.addTrack(n.getTracks()[0]),F)console.log(F[r].getSenders()),F[r].getSenders()[0].replaceTrack(n.getTracks()[0]);e.next=20;break;case 17:e.prev=17,e.t0=e.catch(8),console.error("Could not get user media",e.t0);case 20:case"end":return e.stop()}}),e,null,[[8,17]])})))),S.current.addEventListener("click",Object(k.a)(h.a.mark((function e(){var t,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w((function(e){return!e})),console.log(a.getTracks()),"live"!==(t=a.getTracks().find((function(e){return"video"===e.kind}))).readyState){e.next=8;break}t.enabled=!t.enabled,setTimeout((function(){t.stop()}),500),e.next=20;break;case 8:return e.prev=8,e.next=11,navigator.mediaDevices.getUserMedia({video:{width:1280,height:720}});case 11:for(r in n=e.sent,a.removeTrack(t),a.addTrack(n.getTracks()[0]),F)console.log(F[r].getSenders()),F[r].getSenders()[1].replaceTrack(n.getTracks()[0]);e.next=20;break;case 17:e.prev=17,e.t0=e.catch(8),console.error("Could not get user media",e.t0);case 20:case"end":return e.stop()}}),e,null,[[8,17]])})))),o.on("room_created",Object(k.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket event callback: room_created");case 1:case"end":return e.stop()}}),e)})))),o.on("room_joined",Object(k.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket event callback: room_joined"),o.emit("start_call",i,r);case 2:case"end":return e.stop()}}),e)})))),o.on("start_call",function(){var e=Object(k.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: start_call from "+t),z(n=new RTCPeerConnection(U)),F[t]=n,D(t+" joined","success"),n.ontrack=function(e){G(e,t)},n.onicecandidate=function(e){V(e,t)},e.next=9,B(n,t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o.on("webrtc_offer",function(){var e=Object(k.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: webrtc_offer from "+n),z(r=new RTCPeerConnection(U)),F[n]=r,r.ontrack=function(e){G(e,n)},r.onicecandidate=function(e){V(e,n)},r.setRemoteDescription(new RTCSessionDescription(t)),e.next=9,J(r,n);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o.on("webrtc_answer",(function(e,t){console.log("Socket event callback: webrtc_answer from "+t),F[t].setRemoteDescription(new RTCSessionDescription(e))})),o.on("webrtc_ice_candidate",(function(e,t){console.log("Socket event callback: webrtc_ice_candidate from "+t);var n=new RTCIceCandidate({sdpMLineIndex:e.label,candidate:e.candidate});F[t].addIceCandidate(n)})),o.on("user-disconnected",(function(e){D(e+" left","error"),F[e]&&F[e].close();var t=document.getElementById(e);t&&(t.remove(),d((function(e){return e-1})))}));case 24:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}())}),[]);var R=function(e,t,n,r){t.srcObject=n,t.setAttribute("id",r),t.classList.add("video"),t.addEventListener("loadedmetadata",(function(){t.play()})),e.append(t)};function z(e){a.getTracks().forEach((function(t){e.addTrack(t,a)}))}function B(e,t){return P.apply(this,arguments)}function P(){return(P=Object(k.a)(h.a.mark((function e(t,n){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createOffer();case 3:c=e.sent,t.setLocalDescription(c),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:o.emit("webrtc_offer",{type:"webrtc_offer",sdp:c,roomId:i},n,r);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function J(e,t){return q.apply(this,arguments)}function q(){return(q=Object(k.a)(h.a.mark((function e(t,n){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createAnswer();case 3:c=e.sent,t.setLocalDescription(c),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:o.emit("webrtc_answer",{type:"webrtc_answer",sdp:c,roomId:i},n,r);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function G(e,t){if(console.log(e),"video"===e.track.kind){var n=document.createElement("video");R(c,n,e.streams[0],t)}}function V(e,t){e.candidate&&o.emit("webrtc_ice_candidate",{roomId:i,label:e.candidate.sdpMLineIndex,candidate:e.candidate.candidate},r)}return Object(m.jsxs)("div",{className:e.root,children:[Object(m.jsx)("div",{id:"video-grid",className:e.grid,style:{gridTemplateColumns:"repeat(auto-fill, ".concat(l>0?100/l:100,"vw)"),gridAutoRows:"calc(100vh - 70px)"}}),Object(m.jsxs)("div",{className:e.controls,children:[Object(m.jsx)(y.a,{ref:T,style:{color:b?"grey":"red",marginRight:"10px"},children:b?Object(m.jsx)(C.a,{style:{fontSize:"30px"}}):Object(m.jsx)(_.a,{style:{fontSize:"30px"}})}),Object(m.jsx)(y.a,{ref:S,style:{color:x?"grey":"red",marginLeft:"10px"},children:x?Object(m.jsx)(E.a,{style:{fontSize:"30px"}}):Object(m.jsx)(L.a,{style:{fontSize:"30px"}})})]})]})},B=[{path:"/",children:[{path:"/",element:Object(m.jsx)(j,{})},{path:"/:roomId",element:Object(m.jsx)(z,{})},{path:"*",element:Object(m.jsx)(u.a,{to:"/",replace:!0})}]}];var P=function(){var e=Object(u.h)(B);return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(O.a,{maxSnack:3,children:e})})},J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,181)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))},q=n(34);d.a.render(Object(m.jsx)(q.a,{children:Object(m.jsx)(P,{})}),document.getElementById("root")),J()}},[[158,1,2]]]);
//# sourceMappingURL=main.ce772658.chunk.js.map