(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{101:function(e,t,n){},102:function(e,t,n){},126:function(e,t,n){},128:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=128},158:function(e,t,n){"use strict";n.r(t);var c,r,o,a,s,i=n(0),l=n(9),d=n.n(l),u=(n(101),n(102),n(2)),f=n(16),p=n(174),b=n(176),g=n(83),v=n.n(g),j=n(4),m=function(){var e=Object(u.f)(),t=Object(i.useState)(""),n=Object(f.a)(t,2),c=n[0],r=n[1];return Object(i.useEffect)((function(){v.a.get("/api/call").then((function(e){console.log(e.data),r(e.data)})).catch((function(e){console.log(e.response)}))}),[]),Object(j.jsxs)("div",{style:{margin:"0px 0px 0px 30px"},children:[Object(j.jsx)("h1",{style:{textAlign:"left"},children:"Video Conference App"}),Object(j.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(j.jsx)(p.a,{children:"Your meeting ID"}),Object(j.jsx)("div",{style:{padding:"10px 10px",margin:"0px 20px",backgroundColor:"rgb(0,0,0,0.1)"},children:c})]}),Object(j.jsx)("div",{style:{display:"flex"},children:Object(j.jsx)(b.a,{variant:"contained",style:{backgroundColor:"rgb(0, 131, 255)",color:"white",margin:"20px 100px"},onClick:function(){e("/".concat(c))},children:"JOIN MEETING"})})]})},x=n(6),h=n.n(x),k=n(23),O=(n(126),n(178)),w=n(48),y=n(179),T=n(86),S=n.n(T),C=n(87),_=n.n(C),I=n(88),E=n.n(I),D=n(89),L=n.n(D),R=(n(127),n(85)),N=n.n(R),M=Object(O.a)({root:{backgroundColor:"#141414"},grid:{height:"100vh",display:"flex"},controls:{backgroundColor:"white",height:"70px",width:"100vw",position:"absolute",bottom:0,display:"flex",justifyContent:"center",alignItems:"center"}}),A={audio:!0,video:{width:1280,height:720}},U={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"}]},F={},z=function(){var e=M(),t=Object(i.useState)(0),n=Object(f.a)(t,2),l=n[0],d=n[1],u=Object(i.useState)(!0),p=Object(f.a)(u,2),b=p[0],g=p[1],v=Object(i.useState)(!0),m=Object(f.a)(v,2),x=m[0],O=m[1],T=Object(i.useState)({}),C=Object(f.a)(T,2),I=(C[0],C[1],Object(i.useRef)(null)),D=Object(i.useRef)(null);Object(w.b)().enqueueSnackbar;Object(i.useEffect)((function(){a=N.a.connect("/");var e=window.location.href;s=e.split("/")[e.split("/").length-1],r=document.getElementById("video-grid");var t=document.createElement("video");t.muted=!0,a.on("connected",function(){var e=Object(k.a)(h.a.mark((function e(n){var i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),c=n,console.log("User Id : "+c),e.prev=3,e.next=6,navigator.mediaDevices.getUserMedia(A);case 6:i=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("Could not get user media",e.t0);case 12:o=i,R(r,t,i,c),a.emit("join-room",s,c),I.current.addEventListener("click",Object(k.a)(h.a.mark((function e(){var t,n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(o.getTracks()),!(t=o.getTracks().find((function(e){return"audio"===e.kind})))){e.next=8;break}g(!1),t.enabled=!t.enabled,setTimeout((function(){t.stop(),o.removeTrack(t)}),500),e.next=20;break;case 8:return g(!0),e.prev=9,e.next=12,navigator.mediaDevices.getUserMedia({audio:!0});case 12:n=e.sent,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(9),console.error("Could not get user media",e.t0);case 18:for(c in o.addTrack(n.getTracks()[0]),F)console.log(F[c].getSenders()),F[c].getSenders()[0].replaceTrack(n.getTracks()[0]);case 20:case"end":return e.stop()}}),e,null,[[9,15]])})))),D.current.addEventListener("click",Object(k.a)(h.a.mark((function e(){var t,n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(o.getTracks()),!(t=o.getTracks().find((function(e){return"video"===e.kind})))){e.next=8;break}O(!1),t.enabled=!t.enabled,setTimeout((function(){t.stop(),o.removeTrack(t)}),500),e.next=20;break;case 8:return O(!0),e.prev=9,e.next=12,navigator.mediaDevices.getUserMedia({video:{width:1280,height:720}});case 12:n=e.sent,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(9),console.error("Could not get user media",e.t0);case 18:for(c in o.addTrack(n.getTracks()[0]),F)console.log(F[c].getSenders()),F[c].getSenders()[1].replaceTrack(n.getTracks()[0]);case 20:case"end":return e.stop()}}),e,null,[[9,15]])})))),a.on("room_created",Object(k.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket event callback: room_created"),!0;case 2:case"end":return e.stop()}}),e)})))),a.on("room_joined",Object(k.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket event callback: room_joined"),a.emit("start_call",s,c);case 2:case"end":return e.stop()}}),e)})))),a.on("start_call",function(){var e=Object(k.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: start_call from "+t),z(n=new RTCPeerConnection(U)),F[t]=n,n.ontrack=function(e){console.log(e),G(e,t)},n.onicecandidate=function(e){V(e,t)},e.next=8,B(n,t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.on("webrtc_offer",function(){var e=Object(k.a)(h.a.mark((function e(t,n){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: webrtc_offer from "+n),z(c=new RTCPeerConnection(U)),F[n]=c,c.ontrack=function(e){G(e,n)},c.onicecandidate=function(e){V(e,n)},c.setRemoteDescription(new RTCSessionDescription(t)),e.next=9,J(c,n);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),a.on("webrtc_answer",(function(e,t){console.log("Socket event callback: webrtc_answer from "+t),console.log(F),F[t].setRemoteDescription(new RTCSessionDescription(e))})),a.on("webrtc_ice_candidate",(function(e,t){console.log("Socket event callback: webrtc_ice_candidate from "+t);var n=new RTCIceCandidate({sdpMLineIndex:e.label,candidate:e.candidate});F[t].addIceCandidate(n)})),a.on("user-disconnected",(function(e){console.log(e+" disconnected"),F[e]&&F[e].close();var t=document.getElementById(e);t&&(t.remove(),d((function(e){return e-1})))}));case 24:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}())}),[]);var R=function(e,t,n,c){t.srcObject=n,t.setAttribute("id",c),t.classList.add("video"),t.addEventListener("loadedmetadata",(function(){t.play()})),e.append(t)};function z(e){o.getTracks().forEach((function(t){e.addTrack(t,o)}))}function B(e,t){return P.apply(this,arguments)}function P(){return(P=Object(k.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createOffer();case 3:r=e.sent,t.setLocalDescription(r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:a.emit("webrtc_offer",{type:"webrtc_offer",sdp:r,roomId:s},n,c);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function J(e,t){return q.apply(this,arguments)}function q(){return(q=Object(k.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createAnswer();case 3:r=e.sent,t.setLocalDescription(r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:a.emit("webrtc_answer",{type:"webrtc_answer",sdp:r,roomId:s},n,c);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function G(e,t){if(console.log(e),"video"===e.track.kind){var n=document.createElement("video");R(r,n,e.streams[0],t)}}function V(e,t){e.candidate&&a.emit("webrtc_ice_candidate",{roomId:s,label:e.candidate.sdpMLineIndex,candidate:e.candidate.candidate},c)}return Object(j.jsxs)("div",{className:e.root,children:[Object(j.jsx)("div",{id:"video-grid",className:e.grid,style:{gridTemplateColumns:"repeat(auto-fill, ".concat(l>0?100/l:100,"vw)"),gridAutoRows:"calc(100vh - 70px)"}}),Object(j.jsxs)("div",{className:e.controls,children:[Object(j.jsx)(y.a,{ref:I,style:{color:b?"grey":"red",marginRight:"10px"},children:b?Object(j.jsx)(S.a,{style:{fontSize:"30px"}}):Object(j.jsx)(_.a,{style:{fontSize:"30px"}})}),Object(j.jsx)(y.a,{ref:D,style:{color:x?"grey":"red",marginLeft:"10px"},children:x?Object(j.jsx)(E.a,{style:{fontSize:"30px"}}):Object(j.jsx)(L.a,{style:{fontSize:"30px"}})})]})]})},B=[{path:"/",children:[{path:"/",element:Object(j.jsx)(m,{})},{path:"/:roomId",element:Object(j.jsx)(z,{})},{path:"*",element:Object(j.jsx)(u.a,{to:"/",replace:!0})}]}];var P=function(){var e=Object(u.h)(B);return Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(w.a,{maxSnack:3,children:e})})},J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,181)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),o(e),a(e)}))},q=n(34);d.a.render(Object(j.jsx)(q.a,{children:Object(j.jsx)(P,{})}),document.getElementById("root")),J()}},[[158,1,2]]]);
//# sourceMappingURL=main.ba3342a5.chunk.js.map