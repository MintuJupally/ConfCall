(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{123:function(e,t,n){},147:function(e,t,n){},177:function(e,t,n){"use strict";n.r(t);var c,r,a,o,i,s,l,d=n(0),u=n.n(d),p=n(11),f=n.n(p),b=(n(123),n(5)),j=n(10),x=n(47),g=n(103),m=n.n(g),h=n(205),v=n(206),O=n(215),w=n(112),y=n(216),k=n(208),C=n(105),S=n.n(C),I=n(214),T=n(58),E=n.n(T),_=n(2),L=function(e){return Object(_.jsx)(I.a,Object(x.a)({elevation:6,variant:"filled"},e))},R=function(){var e=Object(b.f)(),t=Object(d.useState)(""),n=Object(j.a)(t,2),c=n[0],r=n[1],a=Object(d.useState)(!1),o=Object(j.a)(a,2),i=o[0],s=o[1],l=Object(d.useState)(0),u=Object(j.a)(l,2),p=u[0],f=u[1],x=Object(d.useState)(null),g=Object(j.a)(x,2),C=g[0],I=g[1];Object(d.useEffect)((function(){var e=window.location.pathname;console.log(e),"/"!==e?r(e.substr(1)):E.a.get("/api/call").then((function(e){console.log(e.data),r(e.data)})).catch((function(e){console.log(e.response)}))}),[]);var T=function(e,t){"clickaway"!==t&&s(!1)};Object(d.useEffect)((function(){C&&f(1)}),[C]);return Object(_.jsxs)("div",{style:{minHeight:"100vh",margin:"0px 30px"},children:[Object(_.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(_.jsx)(S.a,{style:{width:"50px",height:"50px",marginRight:"14px",color:"rgb(0, 131, 255)"}}),Object(_.jsx)("h1",{style:{textAlign:"left",padding:"20px 0px",margin:0},children:"Conference Call"})]}),Object(_.jsxs)("div",{style:{dispaly:"flex",flexDirection:"column",maxWidth:"fit-content",margin:"100px auto 0px auto"},children:[Object(_.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",margin:"20px 0px"},children:[Object(_.jsx)(h.a,{style:{fontSize:"18px"},children:"Meeting ID\xa0\xa0\xa0"}),Object(_.jsxs)("div",{style:{display:"flex",maxWidth:"100%"},children:[Object(_.jsx)("div",{style:{padding:"10px 14px",overflowY:"overlay",backgroundColor:"rgb(0,0,0,0.1)"},children:Object(_.jsx)(h.a,{style:{whiteSpace:"nowrap"},children:c})}),Object(_.jsx)(v.a,{variant:"outlined",style:{borderRadius:0},onClick:function(){var e=document.createElement("textarea");"/"===window.location.pathname?e.value=window.location.href+c:e.value=window.location.href,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),s(!0)},children:"COPY"})]})]}),Object(_.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:C?Object(_.jsx)(v.a,{variant:"contained",style:{backgroundColor:"rgb(0, 131, 255)",color:"white"},onClick:function(){e("/".concat(c),{state:{user:C}})},children:"/"===window.location.pathname?"START MEETING":"JOIN MEETING"}):null}),Object(_.jsx)(O.a,{open:i,autoHideDuration:3e3,onClose:T,children:Object(_.jsx)(L,{severity:"success",onClose:T,children:"Copied to Clipboard"})})]}),Object(_.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(_.jsx)(m.a,{className:"google-login",clientId:"673970648113-sle0qvep0tjdcnfroiqeoetgrbcn8k88.apps.googleusercontent.com",render:function(e){return-1===p?Object(_.jsxs)(v.a,{variant:"outlined",color:"default",onClick:e.onClick,style:{padding:10,margin:20,textTransform:"none"},children:[Object(_.jsx)(w.a,{children:Object(_.jsxs)("g",{xmlns:"http://www.w3.org/2000/svg",transform:"matrix(1, 0, 0, 1, 27.009001, -39.238998)",children:[Object(_.jsx)("path",{fill:"#4285F4",d:"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z"}),Object(_.jsx)("path",{fill:"#34A853",d:"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z"}),Object(_.jsx)("path",{fill:"#FBBC05",d:"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.724 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z"}),Object(_.jsx)("path",{fill:"#EA4335",d:"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.789 L -6.734 42.369 C -8.804 40.429 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z"})]})}),"\xa0\xa0 Login with Google"]}):1===p?Object(_.jsxs)(v.a,{variant:"outlined",color:"default",onClick:e.onClick,style:{padding:5,margin:30,textTransform:"none",borderRadius:20},children:[Object(_.jsx)(y.a,{src:C.imageUrl,alt:C.givenName,style:{width:"25px",height:"25px"}}),Object(_.jsx)("div",{style:{padding:"0px 10px 0px 10px"},children:Object(_.jsxs)("p",{style:{margin:0},children:[" ",C.email]})})]}):Object(_.jsx)(k.a,{style:{color:"rgb(0, 131, 255)",margin:"40px 0px"}})},isSignedIn:!0,onSuccess:function(e){console.log("logging in ..."),console.log(e),I(e.profileObj)},onFailure:function(e){console.log(e),C||f(-1)},cookiePolicy:"single_host_origin",icon:!1,padding:100,onAutoLoadFinished:function(e){e||f(-1)}})})]})},D=n(25),N=n(7),A=n.n(N),M=n(16),B=(n(147),n(4)),F=n(210),z=n(31),P=n(61),U=Object(F.a)({bubble:{boxShadow:"0px 1px 5px rgb(40,40,40,0.2)",padding:"2px 9px",borderRadius:"13px",margin:"2px 3px"}}),q=function(e){var t=e.messages,n=U(),c=Object(d.useState)(t),r=Object(j.a)(c,2),a=r[0],o=r[1];return Object(d.useEffect)((function(){o(t)}),[t]),Object(_.jsx)("div",{id:"chat-screen",style:{overflowY:"auto",height:"calc(100vh - 240px)",padding:"0px 10px",display:"flex",flexDirection:"column-reverse"},children:a.slice(0).reverse().map((function(e,t){var c=e.time.toTimeString(),r=c.split(":")[0]+":"+c.split(":")[1];return parseInt(c.split(":")[0])<12?r+=" AM":r+=" PM",Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{style:{fontSize:"14px",display:"flex",justifyContent:"me"===e.user?"flex-end":"flex-start",textAlign:"left"},children:Object(_.jsxs)("div",{className:n.bubble,style:{backgroundColor:"me"===e.user?"rgb(0, 101, 255,0.3)":"white",whiteSpace:"pre-wrap"},children:[e.message.split("\n").map((function(e,t){return""===e?Object(_.jsx)("br",{},"part-"+t):Object(_.jsx)(u.a.Fragment,{children:Object(_.jsx)("p",{style:{padding:0,margin:0,maxWidth:"min(60vw,250px)",wordWrap:"break-word"},children:e})},"part-"+t)})),Object(_.jsx)("div",{style:{fontSize:"10px",color:"grey",textAlign:"right"},children:r})]})}),Object(_.jsx)("div",{style:{fontWeight:"600",textAlign:"me"===e.user?"right":"left",margin:"0px 5px",fontSize:"13px"},children:0===t||e.user!==a[a.length-t].user?"me"===e.user?"You":e.user:null})]},"message-"+t)}))})},W=n(204),H=n(211),V=n(213),G=n(212),Y=n(67),J=n.n(Y),Z=n(68),K=n.n(Z),X=n(69),Q=n.n(X),$=n(70),ee=n.n($),te=n(106),ne=n.n(te),ce=n(107),re=n.n(ce),ae=n(71),oe=n.n(ae),ie=n(72),se=n.n(ie),le=n(110),de=n.n(le),ue=n(109),pe=n.n(ue),fe=n(108),be=n.n(fe),je=n(66),xe=n.n(je),ge="min(calc(100vw - 20px), 400px)",me=Object(F.a)((function(e){return{chat:{display:"flex"},title:{flexGrow:1},hide:{display:"none"},drawer:{width:ge,flexShrink:0},drawerPaper:{backgroundColor:"rgb(250,250,250)",width:ge,height:"calc(100vh - 80px)",margin:"5px 10px 0px 5px",borderRadius:"20px"},drawerHeader:Object(x.a)(Object(x.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-start"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginRight:NaN},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0},root:{height:"100vh",backgroundColor:"#141414"},grid:{height:"100vh",width:"100vw",display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(min(200px, 50vmin), 1fr))",gridAutoRows:"minmax(min(200px, 50vmin), 1fr)",overflowX:"auto",alignItems:"center",transition:"0.4s ease-in-out"},controls:{height:"70px",position:"fixed",bottom:0,left:0,right:0,margin:"auto",display:"flex",justifyContent:"center",alignItems:"center"},panel:{backgroundColor:"rgb(60,60,60,0.8)",borderRadius:"35px",padding:"0px 30px",display:"flex",alignItems:"center"},loader:{height:"120px",width:"100vw",position:"absolute",bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},join:{textTransform:"none",fontSize:"20px",padding:"4px 20px",marginRight:"15px",fontWeight:600,borderRadius:"30px",transition:"0.3s ease-in-out",color:"white",backgroundColor:"rgb(0, 82, 206)","&:hover":{backgroundColor:"rgb(0, 101, 255)",color:"white"}},inputBox:{outline:0,backgroundColor:"rgb(220,220,220)",width:"300px",border:0,borderRadius:"20px",height:"20px",resize:"none",padding:"10px 15px","&::placeholder":{},"&::-webkit-scrollbar":{display:"none"}},user:{display:"flex",justifyContent:"space-between",cursor:"pointer",padding:"10px",backgroundColor:"rgb(250,250,250)",transition:"0.4s ease-in-out","&:hover":{backgroundColor:"rgb(240,240,240)"}}}})),he={audio:!0,video:{width:1280,height:720}},ve={iceServers:[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun1.l.google.com:19302"},{url:"stun:stun2.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"},{url:"stun:stun4.l.google.com:19302"},{url:"stun:stun.12connect.com:3478"},{url:"stun:stun.12voip.com:3478"}]},Oe=!0,we=null,ye={},ke={},Ce=[],Se=function(e){e.user;var t=me(),n=Object(z.a)(),u=Object(d.useState)(-1),p=Object(j.a)(u,2),f=p[0],b=p[1],x=Object(d.useState)(!0),g=Object(j.a)(x,2),m=g[0],h=g[1],O=Object(d.useState)(!1),w=Object(j.a)(O,2),y=w[0],C=w[1],S=Object(d.useState)(""),I=Object(j.a)(S,2),T=I[0],L=I[1],R=Object(d.useState)([]),N=Object(j.a)(R,2),F=N[0],U=N[1],Y=Object(d.useState)(!0),Z=Object(j.a)(Y,2),X=Z[0],$=Z[1],te=Object(d.useState)(!0),ce=Object(j.a)(te,2),ae=ce[0],ie=ce[1],le=Object(d.useState)(!1),ue=Object(j.a)(le,2),fe=ue[0],je=ue[1],ge=Object(d.useState)(!1),Se=Object(j.a)(ge,2),Ie=Se[0],Te=Se[1],Ee=Object(d.useState)(!1),_e=Object(j.a)(Ee,2),Le=_e[0],Re=_e[1],De=Object(d.useState)(0),Ne=Object(j.a)(De,2),Ae=Ne[0],Me=Ne[1],Be=Object(d.useState)([]),Fe=Object(j.a)(Be,2),ze=Fe[0],Pe=Fe[1],Ue=Object(d.useRef)(null),qe=Object(P.b)().enqueueSnackbar,We=function(e,t){qe(e,{variant:t})};Object(d.useEffect)((function(){if(Ie){Ue.current.focus();var e=document.getElementById("chat-screen");e&&(e.scrollTop=e.scrollHeight)}}),[Ie]),Object(d.useEffect)((function(){document.title=0===Ae?"Conf Call":"(".concat(Ae,") Conf Call")}),[Ae]);var He=function(e,t){var n;t?n=t:n=Ue.current.value.trim();e||s.emit("send-message",n);var c=[].concat(Ce);console.log(c);var r={user:e||"me",message:n,time:new Date};c.push(r),Ce.push(r),U(c)};Object(d.useEffect)((function(){L(""),Ue.current&&Ue.current.focus()}),[F]),Object(d.useEffect)((function(){1===f&&(Ue.current.addEventListener("keyup",(function(e){"Enter"!==e.code&&"Enter"!==e.key||""===e.target.value||e.shiftKey||He()})),Ue.current.addEventListener("keydown",(function(e){"Enter"!==e.code&&"Enter"!==e.key||e.shiftKey||e.preventDefault()})))}),[f]);var Ve=function(){var e=Object(M.a)(A.a.mark((function e(){var t,n,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.location.href,l=t.split("/")[t.split("/").length-1],c=document.getElementById("video-grid"),(n=document.createElement("video")).muted=!0,e.prev=5,e.next=8,navigator.mediaDevices.getUserMedia(he);case 8:r=e.sent,o=r,Ke(c,n,r,"my-video",!0),h(!1),setTimeout((function(){C(!0)}),[1e3]),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(5),alert("Could not get user media. Check your media devices or Refresh"),console.error("Could not get user media",e.t0);case 19:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(){return e.apply(this,arguments)}}();Object(d.useEffect)((function(){return E.a.get("/api/turn").then((function(e){var t=e.data;0!==t.length?(t.forEach((function(e){ve.iceServers.push({url:e})})),console.log("TURN enabled !!!")):console.log("No TURN !!!"),Ve()})).catch((function(e){console.log(e)})),function(){o&&o.getTracks().forEach((function(e){e.stop()})),i&&i.getTracks().forEach((function(e){e.stop()})),s&&s.disconnect(),we&&we.disconnect()}}),[]);var Ge=function(){var e=Object(M.a)(A.a.mark((function e(t){var n,c,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($((function(e){return!e})),"live"!==(n=o.getTracks().find((function(e){return"audio"===e.kind}))).readyState){e.next=7;break}n.enabled=!n.enabled,setTimeout((function(){n.stop()}),500),e.next=20;break;case 7:return e.prev=7,e.next=10,navigator.mediaDevices.getUserMedia({audio:!0});case 10:if(c=e.sent,o.removeTrack(n),o.addTrack(c.getTracks()[0]),t)for(r in ye)ye[r].getSenders()[0].replaceTrack(c.getTracks()[0]);e.next=20;break;case 16:e.prev=16,e.t0=e.catch(7),alert("Could not get user media. Check your media devices or Refresh"),console.error("Could not get user media",e.t0);case 20:case"end":return e.stop()}}),e,null,[[7,16]])})));return function(t){return e.apply(this,arguments)}}(),Ye=function(){var e=Object(M.a)(A.a.mark((function e(t){var n,c,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ie((function(e){return!e})),"live"!==(n=o.getTracks().find((function(e){return"video"===e.kind}))).readyState){e.next=7;break}n.enabled=!n.enabled,setTimeout((function(){n.stop(),r&&s.emit("video-stopped",l,r),Je("my-video",!1)}),500),e.next=22;break;case 7:return e.prev=7,e.next=10,navigator.mediaDevices.getUserMedia({video:{width:1280,height:720}});case 10:if(c=e.sent,o.removeTrack(n),o.addTrack(c.getTracks()[0]),t)for(a in ye)console.log(ye[a].getSenders()),console.log(a,ye[a].connectionState),ye[a].getSenders()[1].replaceTrack(c.getTracks()[0]);r&&s.emit("video-started",l,r),Je("my-video",!0),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),alert("Could not get user media. Check your media devices or Refresh"),console.error("Could not get user media",e.t0);case 22:case"end":return e.stop()}}),e,null,[[7,18]])})));return function(t){return e.apply(this,arguments)}}(),Je=function(e,t){var n,c;"my-video"===e?(n=document.getElementById("video-"+e),c=document.getElementById("prof-"+e)):(n=document.getElementById("video-VID-"+e),c=document.getElementById("prof-VID-"+e)),n&&c&&(t&&n.classList.contains("hidden")?(n.classList.remove("hidden"),c.classList.add("hidden")):t||n.classList.contains("hidden")||(c.classList.remove("hidden"),n.classList.add("hidden")))};Object(d.useEffect)((function(){Oe=ae}),[ae]);var Ze=function(){var e=Object(M.a)(A.a.mark((function e(){var t;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==we){e.next=18;break}return e.prev=1,e.next=4,navigator.mediaDevices.getDisplayMedia();case 4:t=e.sent,i=t,je(!0),t.getTracks()[0].onended=function(){je(!1),we.disconnect(),we=null},(we=xe.a.connect("/")).on("connected",function(){var e=Object(M.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b(1),a=t,console.log("Screenshare Id : "+a),we.emit("join-room",l,a,r),we.on("room_created",Object(M.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket event callback: room_created");case 1:case"end":return e.stop()}}),e)})))),we.on("room_joined",Object(M.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket event callback: room_joined"),we.emit("start_call",l,a,!0);case 2:case"end":return e.stop()}}),e)})))),we.on("start_call",function(){var e=Object(M.a)(A.a.mark((function e(t,n){var c,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: start_call from "+t),c=new RTCPeerConnection(ve),i.getTracks().forEach((function(e){c.addTrack(e,i)})),ke[t]=c,c.onicecandidate=function(e){e.candidate&&we.emit("webrtc_ice_candidate",{roomId:l,label:e.candidate.sdpMLineIndex,candidate:e.candidate.candidate},a)},e.prev=5,e.next=8,c.createOffer();case 8:r=e.sent,c.setLocalDescription(r),we.emit("webrtc_offer",{type:"webrtc_offer",sdp:r,roomId:l},t,a,!0),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,n){return e.apply(this,arguments)}}()),we.on("webrtc_offer",function(){var e=Object(M.a)(A.a.mark((function e(t,n,c){var r,o;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: webrtc_offer from "+n),r=new RTCPeerConnection(ve),i.getTracks().forEach((function(e){r.addTrack(e,i)})),ke[n]=r,r.onicecandidate=function(e){e.candidate&&we.emit("webrtc_ice_candidate",{roomId:l,label:e.candidate.sdpMLineIndex,candidate:e.candidate.candidate},a)},r.setRemoteDescription(new RTCSessionDescription(t)),e.prev=6,e.next=9,r.createAnswer();case 9:o=e.sent,r.setLocalDescription(o),we.emit("webrtc_answer",{type:"webrtc_answer",sdp:o,roomId:l},n,a),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(6),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t,n,c){return e.apply(this,arguments)}}()),we.on("webrtc_answer",(function(e,t){console.log("Socket event callback: webrtc_answer from "+t),ke[t].setRemoteDescription(new RTCSessionDescription(e))})),we.on("webrtc_ice_candidate",(function(e,t){console.log("Socket event callback: webrtc_ice_candidate from "+t);var n=new RTCIceCandidate({sdpMLineIndex:e.label,candidate:e.candidate});ke[t].addIceCandidate(n)})),we.on("user-disconnected",(function(e){console.log("scrSocket disconnecting "+e),ke[e]&&ke[e].close();var t=document.getElementById("AUD-"+e);t&&t.remove();var n=document.getElementById("VID-"+e);n&&n.remove()}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),alert("Could not get display media. Try again"),console.error("Could not get display media",e.t0);case 16:e.next=22;break;case 18:je(!1),we.disconnect(),we=null,i.getTracks().forEach((function(e){e.stop()}));case 22:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),Ke=function(e,t,n,c,r){var o;if(t.setAttribute("id","video-"+c),t.srcObject=n,t.classList.add("video"),t.addEventListener("loadedmetadata",(function(){t.play()})),"my-video"!==c&&c.substring(4)!==a&&(console.log(c,c.substring(3),a),t.addEventListener("dblclick",(function(){t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}))),c.startsWith("VID-")||"my-video"===c){(o=document.createElement("div")).setAttribute("id",c),o.classList.add("video-wrap");var i=document.createElement("div");i.setAttribute("id","prof-"+c),i.classList.add("prof-card"),i.classList.add("hidden");var s=document.createElement("p");s.innerText=c,s.classList.add("prof-text"),i.append(s),o.append(t),o.append(i),e.append(o),r||(t.classList.add("hidden"),i.classList.remove("hidden"))}else e.append(t)};function Xe(e){o.getTracks().forEach((function(t){e.addTrack(t,o)}))}function Qe(e,t){return $e.apply(this,arguments)}function $e(){return($e=Object(M.a)(A.a.mark((function e(t,n){var c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createOffer();case 3:c=e.sent,t.setLocalDescription(c),console.log("emitting ",Oe),s.emit("webrtc_offer",{type:"webrtc_offer",sdp:c,roomId:l},n,r,Oe),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function et(e,t){return tt.apply(this,arguments)}function tt(){return(tt=Object(M.a)(A.a.mark((function e(t,n){var c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createAnswer();case 3:c=e.sent,t.setLocalDescription(c),s.emit("webrtc_answer",{type:"webrtc_answer",sdp:c,roomId:l},n,r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function nt(e,t,n){if("audio"===e.track.kind){var r=document.createElement("audio");Ke(c,r,e.streams[0],"AUD-"+t,n)}else if("video"===e.track.kind){var a=document.createElement("video");a.muted=!0,Ke(c,a,e.streams[0],"VID-"+t,n)}}function ct(e,t){e.candidate&&s.emit("webrtc_ice_candidate",{roomId:l,label:e.candidate.sdpMLineIndex,candidate:e.candidate.candidate},r)}return Object(_.jsxs)("div",{className:t.root,children:[Object(_.jsx)("div",{id:"video-grid",className:t.grid,children:m?Object(_.jsx)(k.a,{style:{margin:"auto"}}):null}),y?Object(_.jsx)("div",{className:t.controls,children:Object(_.jsxs)("div",{className:t.panel,children:[-1===f?Object(_.jsx)(v.a,{variant:"outlined",onClick:function(){(s=xe.a.connect("/")).on("connected",function(){var e=Object(M.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b(1),r=t,console.log("User Id : "+r),s.emit("join-room",l,r),s.on("room_created",Object(M.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket event callback: room_created");case 1:case"end":return e.stop()}}),e)})))),s.on("room_joined",Object(M.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket event callback: room_joined"),s.emit("start_call",l,r,ae);case 2:case"end":return e.stop()}}),e)})))),s.on("start_call",function(){var e=Object(M.a)(A.a.mark((function e(t,n){var c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: start_call from "+t),Xe(c=new RTCPeerConnection(ve)),ye[t]=c,Pe((function(e){return[].concat(Object(D.a)(e),[t])})),console.log(ye[t].connectionState),console.log("before "+Oe),We(t+" joined","success"),c.ontrack=function(e){nt(e,t,n)},c.onicecandidate=function(e){ct(e)},c.onconnectionstatechange=function(e){console.log(e),console.log(c.connectionState),"failed"===c.connectionState&&(console.log("Restarting Ice ..."),c.restartIce())},e.next=13,Qe(c,t);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),s.on("webrtc_offer",function(){var e=Object(M.a)(A.a.mark((function e(t,n,c){var r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: webrtc_offer from "+n,c),Xe(r=new RTCPeerConnection(ve)),ye[n]=r,Pe((function(e){return[].concat(Object(D.a)(e),[n])})),r.ontrack=function(e){nt(e,n,c)},r.onicecandidate=function(e){ct(e)},r.setRemoteDescription(new RTCSessionDescription(t)),r.onconnectionstatechange=function(e){console.log(e),console.log(r.connectionState)},e.next=11,et(r,n);case 11:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}()),s.on("webrtc_answer",(function(e,t){console.log("Socket event callback: webrtc_answer from "+t),ye[t].setRemoteDescription(new RTCSessionDescription(e))})),s.on("webrtc_ice_candidate",(function(e,t){console.log("Socket event callback: webrtc_ice_candidate from "+t);var n=new RTCIceCandidate({sdpMLineIndex:e.label,candidate:e.candidate});ye[t].addIceCandidate(n)})),s.on("video-stopped",(function(e){console.log("video-stopped "+e),Je(e,!1)})),s.on("video-started",(function(e){console.log("video-started "+e),Je(e,!0)})),s.on("connect_screen",(function(e){s.emit("connect_screen",e)})),s.on("incoming-message",(function(e,t){He(e,t),Me((function(e){return e+1}))})),s.on("user-disconnected",(function(e){ye[e]&&ye[e].close(),Pe((function(t){var n=t.filter((function(t){return t!==e}));return console.log(n),n}));var t=document.getElementById("AUD-"+e);t&&t.remove();var n=document.getElementById("VID-"+e);n&&(n.remove(),We(e+" left","error"))}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),b(0)},className:t.join,children:"Join"}):0===f?Object(_.jsx)("div",{children:Object(_.jsx)(k.a,{style:{width:"30px",height:"30px",margin:"0px 15px"}})}):null,Object(_.jsx)(W.a,{style:{color:X?"white":"red",marginRight:"10px"},onClick:function(){Ge(1===f)},children:X?Object(_.jsx)(J.a,{style:{fontSize:"30px"}}):Object(_.jsx)(K.a,{style:{fontSize:"30px"}})}),Object(_.jsx)(W.a,{style:{color:ae?"white":"red",marginLeft:"10px",marginRight:"10px"},onClick:function(){Ye(1===f)},children:ae?Object(_.jsx)(Q.a,{style:{fontSize:"30px"}}):Object(_.jsx)(ee.a,{style:{fontSize:"30px"}})}),1===f?Object(_.jsx)(W.a,{style:{color:fe?"white":"red",marginLeft:"10px"},onClick:function(){Ze()},children:fe?Object(_.jsx)(ne.a,{style:{fontSize:"30px"}}):Object(_.jsx)(re.a,{style:{fontSize:"30px"}})}):null]})}):null,1===f?Object(_.jsxs)("div",{className:t.chat,children:[Object(_.jsxs)("div",{style:{position:"fixed",top:"10px",right:"20px",backgroundColor:"rgb(60,60,60,0.7)",borderRadius:"30px"},children:[Object(_.jsx)(W.a,{color:"inherit","aria-label":"open drawer",edge:"end",onClick:function(){Re(!0)},className:Object(B.a)(Ie&&t.hide),style:{color:"white",margin:"0px 5px 0px 8px"},children:Object(_.jsx)(be.a,{})}),Object(_.jsx)(W.a,{color:"inherit","aria-label":"open drawer",edge:"end",onClick:function(){Te(!0),Me(0)},className:Object(B.a)(Ie&&t.hide),style:{color:"white",marginRight:"8px"},children:Object(_.jsx)(H.a,{color:"primary",invisible:0===Ae,badgeContent:Ae,children:Object(_.jsx)(pe.a,{})})})]}),Object(_.jsxs)(V.a,{className:t.drawer,variant:"persistent",anchor:"right",open:Le,classes:{paper:t.drawerPaper},children:[Object(_.jsxs)("div",{className:t.drawerHeader,children:[Object(_.jsx)(W.a,{onClick:function(){Re(!1)},children:"rtl"===n.direction?Object(_.jsx)(oe.a,{}):Object(_.jsx)(se.a,{})}),"Attendees"]}),Object(_.jsx)(G.a,{}),Object(_.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",margin:"10px"},children:[Object(_.jsxs)("div",{className:t.user,children:[Object(_.jsx)("div",{children:r+" (You)"}),Object(_.jsxs)("div",{style:{width:"80px",display:"flex",justifyContent:"space-around"},children:[Object(_.jsx)(K.a,{style:{color:"rgb(100,100,100)"}}),Object(_.jsx)(ee.a,{style:{color:"rgb(100,100,100)"}})]})]}),ze.map((function(e,n){return Object(_.jsxs)("div",{className:t.user,children:[Object(_.jsx)("div",{children:e}),Object(_.jsxs)("div",{style:{width:"80px",display:"flex",justifyContent:"space-around"},children:[Object(_.jsx)(J.a,{style:{color:"rgb(0,140,200)"}}),Object(_.jsx)(Q.a,{style:{color:"rgb(0,140,200)"}})]})]},"attendee-"+n)}))]})]}),Object(_.jsxs)(V.a,{className:t.drawer,variant:"persistent",anchor:"right",open:Ie,classes:{paper:t.drawerPaper},children:[Object(_.jsxs)("div",{className:t.drawerHeader,children:[Object(_.jsx)(W.a,{onClick:function(){Te(!1),Me(0)},children:"rtl"===n.direction?Object(_.jsx)(oe.a,{}):Object(_.jsx)(se.a,{})}),"Conversation"]}),Object(_.jsx)(G.a,{}),Object(_.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",margin:"10px"},children:[Object(_.jsx)(q,{messages:F}),Object(_.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(_.jsx)("textarea",{ref:Ue,type:"text",placeholder:"Type a message",className:t.inputBox,value:T,onChange:function(e){!function(e){var t=e.target.value;L(t.trimStart())}(e)}}),Object(_.jsx)(W.a,{disabled:""===T,onClick:function(){He()},children:Object(_.jsx)(de.a,{})})]})]})]})]}):null]})},Ie=function(){var e=Object(b.e)(),t=Object(d.useState)(e.state),n=Object(j.a)(t,2),c=n[0],r=n[1];Object(d.useEffect)((function(){console.log(e.state),r(e.state),e.state&&window.history.replaceState({},document.title)}),[e]);return c&&c.user?Object(_.jsx)(Se,{user:c.user}):Object(_.jsx)(R,{updateFlag:function(e){r({state:{user:e}})}})},Te=[{path:"/",children:[{path:"/",element:Object(_.jsx)(Ie,{})},{path:"/:roomId",element:Object(_.jsx)(Ie,{})},{path:"*",element:Object(_.jsx)(b.a,{to:"/",replace:!0})}]}];var Ee=function(){var e=Object(b.h)(Te);return Object(_.jsx)("div",{className:"App",children:Object(_.jsx)(P.a,{maxSnack:3,children:e})})},_e=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,217)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),a(e),o(e)}))},Le=n(44);f.a.render(Object(_.jsx)(Le.a,{children:Object(_.jsx)(Ee,{})}),document.getElementById("root")),_e()}},[[177,1,2]]]);
//# sourceMappingURL=main.69e01819.chunk.js.map