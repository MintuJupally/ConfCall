{"version":3,"sources":["../node_modules/peerjs/dist sync","components/Meeting.js","components/Home.js","routes.js","App.js","reportWebVitals.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","videoGrid","localStream","socket","roomId","Home","navigate","useNavigate","useState","setRoomId","useEffect","axios","get","then","res","console","log","data","catch","err","response","style","margin","textAlign","display","alignItems","Typography","padding","backgroundColor","Button","variant","color","onClick","useStyles","makeStyles","root","grid","height","controls","width","position","bottom","justifyContent","mediaConstraints","audio","video","iceServers","urls","conn","Meeting","classes","count","setCount","mic","setMic","cam","setCam","micButton","useRef","camButton","useSnackbar","enqueueSnackbar","io","connect","url","window","location","href","split","length","document","getElementById","myVideo","createElement","muted","on","myId","a","navigator","mediaDevices","getUserMedia","stream","error","addVideoStream","emit","current","addEventListener","getTracks","audTrack","find","el","kind","enabled","setTimeout","stop","removeTrack","userId","addTrack","getSenders","replaceTrack","vidTrack","addLocalTracks","rtcPeerConnection","RTCPeerConnection","ontrack","event","setRemoteStream","onicecandidate","sendIceCandidate","createOffer","setRemoteDescription","RTCSessionDescription","createAnswer","candidate","RTCIceCandidate","sdpMLineIndex","label","addIceCandidate","close","vidEl","remove","srcObject","setAttribute","classList","add","play","append","forEach","track","sessionDescription","setLocalDescription","type","sdp","streams","className","gridTemplateColumns","gridAutoRows","IconButton","ref","marginRight","fontSize","marginLeft","routes","path","children","element","to","replace","App","routing","useRoutes","maxSnack","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render"],"mappings":"qJAAA,SAASA,EAAoBC,GAC5B,IAAIC,EAAI,IAAIC,MAAM,uBAAyBF,EAAM,KAEjD,MADAC,EAAEE,KAAO,mBACHF,EAEPF,EAAoBK,KAAO,WAAa,MAAO,IAC/CL,EAAoBM,QAAUN,EAC9BO,EAAOC,QAAUR,EACjBA,EAAoBS,GAAK,K,4CC+CrBA,EACAC,EACAC,EAIAC,EACAC,E,gGCFWC,EApDF,WACX,IAAMC,EAAWC,cAEjB,EAA4BC,mBAAS,IAArC,mBAAOJ,EAAP,KAAeK,EAAf,KAcA,OAZAC,qBAAU,WACRC,IACGC,IAAI,aACJC,MAAK,SAACC,GACLC,QAAQC,IAAIF,EAAIG,MAChBR,EAAUK,EAAIG,SAEfC,OAAM,SAACC,GACNJ,QAAQC,IAAIG,EAAIC,eAEnB,IAGD,sBAAKC,MAAO,CAAEC,OAAQ,oBAAtB,UACE,oBAAID,MAAO,CAAEE,UAAW,QAAxB,kCAEA,sBAAKF,MAAO,CAAEG,QAAS,OAAQC,WAAY,UAA3C,UACE,cAACC,EAAA,EAAD,8BACA,qBACEL,MAAO,CACLM,QAAS,YACTL,OAAQ,WACRM,gBAAiB,kBAJrB,SAOGxB,OAGL,qBAAKiB,MAAO,CAAEG,QAAS,QAAvB,SACE,cAACK,EAAA,EAAD,CACEC,QAAQ,YACRT,MAAO,CACLO,gBAAiB,mBACjBG,MAAO,QACPT,OAAQ,cAEVU,QAAS,WACP1B,EAAS,IAAD,OAAKF,KARjB,gC,yJDtBF6B,EAAYC,YAAW,CAC3BC,KAAM,CACJP,gBAAiB,WAEnBQ,KAAM,CACJC,OAAQ,QACRb,QAAS,QAEXc,SAAU,CACRV,gBAAiB,QACjBS,OAAQ,OACRE,MAAO,QACPC,SAAU,WACVC,OAAQ,EACRjB,QAAS,OACTkB,eAAgB,SAChBjB,WAAY,YAIVkB,EAAmB,CACvBC,OAAO,EACPC,MAAO,CAAEN,MAAO,KAAMF,OAAQ,MAG1BS,EAAa,CACjBA,WAAY,CACV,CAAEC,KAAM,gCACR,CAAEA,KAAM,iCACR,CAAEA,KAAM,iCACR,CAAEA,KAAM,iCACR,CAAEA,KAAM,mCAaRC,EAAO,GA6VIC,EA3VC,WACd,IAAMC,EAAUjB,IAEhB,EAA0BzB,mBAAS,GAAnC,mBAAO2C,EAAP,KAAcC,EAAd,KAEA,EAAsB5C,oBAAS,GAA/B,mBAAO6C,EAAP,KAAYC,EAAZ,KACA,EAAsB9C,oBAAS,GAA/B,mBAAO+C,EAAP,KAAYC,EAAZ,KAEA,EAAoChD,mBAAS,IAA7C,mBAEMiD,GAFN,UAEkBC,iBAAO,OACnBC,EAAYD,iBAAO,MAGGE,cAApBC,gBAqBRnD,qBAAU,WACRP,EAAS2D,IAAGC,QAAQ,KAEpB,IAAMC,EAAMC,OAAOC,SAASC,KAC5B/D,EAAS4D,EAAII,MAAM,KAAKJ,EAAII,MAAM,KAAKC,OAAS,GAEhDpE,EAAYqE,SAASC,eAAe,cAEpC,IAAMC,EAAUF,SAASG,cAAc,SACvCD,EAAQE,OAAQ,EAEhBvE,EAAOwE,GAAG,YAAV,uCAAuB,WAAOC,GAAP,eAAAC,EAAA,6DACrB9D,QAAQC,IAAI4D,GACZ5E,EAAK4E,EAEL7D,QAAQC,IAAI,aAAehB,GAJN,kBAQJ8E,UAAUC,aAAaC,aAAarC,GARhC,OAQnBsC,EARmB,uDAUnBlE,QAAQmE,MAAM,2BAAd,MAVmB,QAarBhF,EAAc+E,EACdE,EAAelF,EAAWuE,EAASS,EAAQjF,GAE3CG,EAAOiF,KAAK,YAAahF,EAAQJ,GAEjCyD,EAAU4B,QAAQC,iBAAiB,QAAnC,sBAA4C,gCAAAT,EAAA,yDAC1C9D,QAAQC,IAAId,EAAYqF,eAEpBC,EAAWtF,EAAYqF,YAAYE,MAAK,SAACC,GAC3C,MAAmB,UAAZA,EAAGC,SAJ8B,gBAOxCrC,GAAO,GACPkC,EAASI,SAAWJ,EAASI,QAE7BC,YAAW,WACTL,EAASM,OACT5F,EAAY6F,YAAYP,KACvB,KAbqC,8BAexClC,GAAO,GAfiC,mBAkBvBwB,UAAUC,aAAaC,aAAa,CACjDpC,OAAO,IAnB6B,QAkBtCqC,EAlBsC,yDAsBtClE,QAAQmE,MAAM,2BAAd,MAtBsC,QA2BxC,IAASc,KAFT9F,EAAY+F,SAAShB,EAAOM,YAAY,IAErBvC,EACjBjC,QAAQC,IAAIgC,EAAKgD,GAAQE,cACzBlD,EAAKgD,GAAQE,aAAa,GAAGC,aAAalB,EAAOM,YAAY,IA7BvB,2DAiC5C5B,EAAU0B,QAAQC,iBAAiB,QAAnC,sBAA4C,gCAAAT,EAAA,yDAC1C9D,QAAQC,IAAId,EAAYqF,eAEpBa,EAAWlG,EAAYqF,YAAYE,MAAK,SAACC,GAC3C,MAAmB,UAAZA,EAAGC,SAJ8B,gBAOxCnC,GAAO,GACP4C,EAASR,SAAWQ,EAASR,QAE7BC,YAAW,WACTO,EAASN,OACT5F,EAAY6F,YAAYK,KACvB,KAbqC,8BAexC5C,GAAO,GAfiC,mBAkBvBsB,UAAUC,aAAaC,aAAa,CACjDnC,MAAO,CAAEN,MAAO,KAAMF,OAAQ,OAnBM,QAkBtC4C,EAlBsC,yDAsBtClE,QAAQmE,MAAM,2BAAd,MAtBsC,QA2BxC,IAASc,KAFT9F,EAAY+F,SAAShB,EAAOM,YAAY,IAErBvC,EACjBjC,QAAQC,IAAIgC,EAAKgD,GAAQE,cACzBlD,EAAKgD,GAAQE,aAAa,GAAGC,aAAalB,EAAOM,YAAY,IA7BvB,2DAmC5CpF,EAAOwE,GAAG,eAAV,sBAA0B,sBAAAE,EAAA,sDACxB9D,QAAQC,IAAI,wCAEI,EAHQ,4CAM1Bb,EAAOwE,GAAG,cAAV,sBAAyB,sBAAAE,EAAA,sDACvB9D,QAAQC,IAAI,sCAEZb,EAAOiF,KAAK,aAAchF,EAAQJ,GAHX,4CAOzBG,EAAOwE,GAAG,aAAV,uCAAwB,WAAOqB,GAAP,eAAAnB,EAAA,6DACtB9D,QAAQC,IAAI,0CAA4CgF,GAGxDK,EADIC,EAAoB,IAAIC,kBAAkBzD,IAG9CE,EAAKgD,GAAUM,EAEfA,EAAkBE,QAAU,SAACC,GAC3B1F,QAAQC,IAAIyF,GACZC,EAAgBD,EAAOT,IAEzBM,EAAkBK,eAAiB,SAACF,GAClCG,EAAiBH,EAAOT,IAbJ,SAgBhBa,EAAYP,EAAmBN,GAhBf,2CAAxB,uDAmBA7F,EAAOwE,GAAG,eAAV,uCAA0B,WAAO8B,EAAOT,GAAd,eAAAnB,EAAA,6DACxB9D,QAAQC,IAAI,4CAA8CgF,GAG1DK,EADIC,EAAoB,IAAIC,kBAAkBzD,IAG9CE,EAAKgD,GAAUM,EAEfA,EAAkBE,QAAU,SAACC,GAC3BC,EAAgBD,EAAOT,IAEzBM,EAAkBK,eAAiB,SAACF,GAClCG,EAAiBH,EAAOT,IAE1BM,EAAkBQ,qBAChB,IAAIC,sBAAsBN,IAfJ,SAkBlBO,EAAaV,EAAmBN,GAlBd,2CAA1B,yDAqBA7F,EAAOwE,GAAG,iBAAiB,SAAC8B,EAAOT,GACjCjF,QAAQC,IAAI,6CAA+CgF,GAE3DjF,QAAQC,IAAIgC,GACZA,EAAKgD,GAAQc,qBAAqB,IAAIC,sBAAsBN,OAG9DtG,EAAOwE,GAAG,wBAAwB,SAAC8B,EAAOT,GACxCjF,QAAQC,IACN,oDAAsDgF,GAIxD,IAAIiB,EAAY,IAAIC,gBAAgB,CAClCC,cAAeV,EAAMW,MACrBH,UAAWR,EAAMQ,YAEnBjE,EAAKgD,GAAQqB,gBAAgBJ,MAG/B9G,EAAOwE,GAAG,qBAAqB,SAACqB,GAC9BjF,QAAQC,IAAIgF,EAAS,iBAEjBhD,EAAKgD,IAAShD,EAAKgD,GAAQsB,QAE/B,IAAMC,EAAQjD,SAASC,eAAeyB,GAClCuB,IACFA,EAAMC,SACNpE,GAAS,SAACD,GAAD,OAAWA,EAAQ,SAvKX,yDAAvB,yDA2KC,IAEH,IAAMgC,EAAiB,SAAClF,EAAW4C,EAAOoC,EAAQjF,GAChD6C,EAAM4E,UAAYxC,EAClBpC,EAAM6E,aAAa,KAAM1H,GACzB6C,EAAM8E,UAAUC,IAAI,SACpB/E,EAAMyC,iBAAiB,kBAAkB,WACvCzC,EAAMgF,UAER5H,EAAU6H,OAAOjF,IAMnB,SAASwD,EAAeC,GACtBpG,EAAYqF,YAAYwC,SAAQ,SAACC,GAC/B1B,EAAkBL,SAAS+B,EAAO9H,MA1OlB,SA8OL2G,EA9OK,gFA8OpB,WAA2BP,EAAmBN,GAA9C,eAAAnB,EAAA,+EAG+ByB,EAAkBO,cAHjD,OAGIoB,EAHJ,OAII3B,EAAkB4B,oBAAoBD,GAJ1C,gDAMIlH,QAAQmE,MAAR,MANJ,QASE/E,EAAOiF,KACL,eACA,CACE+C,KAAM,eACNC,IAAKH,EACL7H,UAEF4F,EACAhG,GAjBJ,0DA9OoB,+BAmQLgH,EAnQK,gFAmQpB,WAA4BV,EAAmBN,GAA/C,eAAAnB,EAAA,+EAG+ByB,EAAkBU,eAHjD,OAGIiB,EAHJ,OAII3B,EAAkB4B,oBAAoBD,GAJ1C,gDAMIlH,QAAQmE,MAAR,MANJ,QASE/E,EAAOiF,KACL,gBACA,CACE+C,KAAM,gBACNC,IAAKH,EACL7H,UAEF4F,EACAhG,GAjBJ,0DAnQoB,sBAwRpB,SAAS0G,EAAgBD,EAAOT,GAE9B,GADAjF,QAAQC,IAAIyF,GACa,UAArBA,EAAMuB,MAAMrC,KAAkB,CAChC,IAAI9C,EAAQyB,SAASG,cAAc,SACnCU,EAAelF,EAAW4C,EAAO4D,EAAM4B,QAAQ,GAAIrC,IAIvD,SAASY,EAAiBH,EAAOT,GAC3BS,EAAMQ,WACR9G,EAAOiF,KACL,uBACA,CACEhF,SACAgH,MAAOX,EAAMQ,UAAUE,cACvBF,UAAWR,EAAMQ,UAAUA,WAE7BjH,GAKN,OACE,sBAAKsI,UAAWpF,EAAQf,KAAxB,UAEE,qBACEnC,GAAG,aACHsI,UAAWpF,EAAQd,KACnBf,MAAO,CACLkH,oBAAoB,qBAAD,OACjBpF,EAAQ,EAAI,IAAMA,EAAQ,IADT,OAGnBqF,aAAc,wBAGlB,sBAAKF,UAAWpF,EAAQZ,SAAxB,UACE,cAACmG,EAAA,EAAD,CACEC,IAAKjF,EACLpC,MAAO,CAAEU,MAAOsB,EAAM,OAAS,MAAOsF,YAAa,QAFrD,SAIGtF,EACC,cAAC,IAAD,CAAgBhC,MAAO,CAAEuH,SAAU,UAEnC,cAAC,IAAD,CAAmBvH,MAAO,CAAEuH,SAAU,YAG1C,cAACH,EAAA,EAAD,CACEC,IAAK/E,EACLtC,MAAO,CAAEU,MAAOwB,EAAM,OAAS,MAAOsF,WAAY,QAFpD,SAIGtF,EACC,cAAC,IAAD,CAAqBlC,MAAO,CAAEuH,SAAU,UAExC,cAAC,IAAD,CAAwBvH,MAAO,CAAEuH,SAAU,mBE7XxCE,EAZA,CACb,CACEC,KAAM,IAENC,SAAU,CACR,CAAED,KAAM,IAAKE,QAAS,cAAC,EAAD,KACtB,CAAEF,KAAM,WAAYE,QAAS,cAAC,EAAD,KAC7B,CAAEF,KAAM,IAAKE,QAAS,cAAC,IAAD,CAAUC,GAAG,IAAIC,SAAO,QCKrCC,MAVf,WACE,IAAMC,EAAUC,YAAUR,GAE1B,OACE,qBAAKR,UAAU,MAAf,SACE,cAAC,IAAD,CAAkBiB,SAAU,EAA5B,SAAgCF,OCDvBG,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqB7I,MAAK,YAAkD,IAA/C8I,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,O,QCCdO,IAASC,OACP,cAAC,IAAD,UACE,cAAC,EAAD,MAEF3F,SAASC,eAAe,SAM1BiF,M","file":"static/js/main.ba3342a5.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 128;","import \"./Meeting.css\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { useSnackbar } from \"notistack\";\n\nimport { IconButton } from \"@material-ui/core\";\n\nimport MicRoundedIcon from \"@material-ui/icons/MicRounded\";\nimport MicOffRoundedIcon from \"@material-ui/icons/MicOffRounded\";\n\nimport VideocamRoundedIcon from \"@material-ui/icons/VideocamRounded\";\nimport VideocamOffRoundedIcon from \"@material-ui/icons/VideocamOffRounded\";\n\nimport FlipCameraAndroidIcon from \"@material-ui/icons/FlipCameraAndroid\";\n\nimport Peer from \"peerjs\";\nimport io from \"socket.io-client\";\n\nconst useStyles = makeStyles({\n  root: {\n    backgroundColor: \"#141414\",\n  },\n  grid: {\n    height: \"100vh\",\n    display: \"flex\",\n  },\n  controls: {\n    backgroundColor: \"white\",\n    height: \"70px\",\n    width: \"100vw\",\n    position: \"absolute\",\n    bottom: 0,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n});\n\nconst mediaConstraints = {\n  audio: true,\n  video: { width: 1280, height: 720 },\n};\n\nconst iceServers = {\n  iceServers: [\n    { urls: \"stun:stun.l.google.com:19302\" },\n    { urls: \"stun:stun1.l.google.com:19302\" },\n    { urls: \"stun:stun2.l.google.com:19302\" },\n    { urls: \"stun:stun3.l.google.com:19302\" },\n    { urls: \"stun:stun4.l.google.com:19302\" },\n  ],\n};\n\nlet id;\nlet videoGrid;\nlet localStream;\nlet remoteStream;\nlet isRoomCreator;\n\nlet socket;\nlet roomId;\n\nlet conn = {};\n\nconst Meeting = () => {\n  const classes = useStyles();\n\n  const [count, setCount] = useState(0);\n\n  const [mic, setMic] = useState(true);\n  const [cam, setCam] = useState(true);\n\n  const [connection, setConnection] = useState({});\n\n  const micButton = useRef(null);\n  const camButton = useRef(null);\n  // const flipButton = useRef(null);\n\n  const { enqueueSnackbar } = useSnackbar();\n\n  const handleClick = (message, variant) => {\n    enqueueSnackbar(message, { variant });\n  };\n\n  const toggleMic = (stream) => {\n    const enabled = stream.getTracks()[0].enabled;\n    stream.getTracks()[0].enabled = !enabled;\n    setMic(!enabled);\n  };\n\n  const toggleCam = (stream) => {\n    const enabled = stream.getTracks()[1].enabled;\n    stream.getTracks()[1].enabled = !enabled;\n    setCam(!enabled);\n\n    // if (flipButton.current)\n    //   flipButton.current.style.display = enabled ? \"none\" : \"block\";\n  };\n\n  useEffect(() => {\n    socket = io.connect(\"/\");\n\n    const url = window.location.href;\n    roomId = url.split(\"/\")[url.split(\"/\").length - 1];\n\n    videoGrid = document.getElementById(\"video-grid\");\n\n    const myVideo = document.createElement(\"video\");\n    myVideo.muted = true;\n\n    socket.on(\"connected\", async (myId) => {\n      console.log(myId);\n      id = myId;\n\n      console.log(\"User Id : \" + id);\n\n      let stream;\n      try {\n        stream = await navigator.mediaDevices.getUserMedia(mediaConstraints);\n      } catch (error) {\n        console.error(\"Could not get user media\", error);\n      }\n\n      localStream = stream;\n      addVideoStream(videoGrid, myVideo, stream, id);\n\n      socket.emit(\"join-room\", roomId, id);\n\n      micButton.current.addEventListener(\"click\", async () => {\n        console.log(localStream.getTracks());\n\n        let audTrack = localStream.getTracks().find((el) => {\n          return el.kind === \"audio\";\n        });\n        if (audTrack) {\n          setMic(false);\n          audTrack.enabled = !audTrack.enabled;\n\n          setTimeout(() => {\n            audTrack.stop();\n            localStream.removeTrack(audTrack);\n          }, 500);\n        } else {\n          setMic(true);\n          let stream;\n          try {\n            stream = await navigator.mediaDevices.getUserMedia({\n              audio: true,\n            });\n          } catch (error) {\n            console.error(\"Could not get user media\", error);\n          }\n\n          localStream.addTrack(stream.getTracks()[0]);\n\n          for (let userId in conn) {\n            console.log(conn[userId].getSenders());\n            conn[userId].getSenders()[0].replaceTrack(stream.getTracks()[0]);\n          }\n        }\n      });\n      camButton.current.addEventListener(\"click\", async () => {\n        console.log(localStream.getTracks());\n\n        let vidTrack = localStream.getTracks().find((el) => {\n          return el.kind === \"video\";\n        });\n        if (vidTrack) {\n          setCam(false);\n          vidTrack.enabled = !vidTrack.enabled;\n\n          setTimeout(() => {\n            vidTrack.stop();\n            localStream.removeTrack(vidTrack);\n          }, 500);\n        } else {\n          setCam(true);\n          let stream;\n          try {\n            stream = await navigator.mediaDevices.getUserMedia({\n              video: { width: 1280, height: 720 },\n            });\n          } catch (error) {\n            console.error(\"Could not get user media\", error);\n          }\n\n          localStream.addTrack(stream.getTracks()[0]);\n\n          for (let userId in conn) {\n            console.log(conn[userId].getSenders());\n            conn[userId].getSenders()[1].replaceTrack(stream.getTracks()[0]);\n          }\n        }\n      });\n\n      // SOCKET EVENT CALLBACKS =====================================================\n      socket.on(\"room_created\", async () => {\n        console.log(\"Socket event callback: room_created\");\n\n        isRoomCreator = true;\n      });\n\n      socket.on(\"room_joined\", async () => {\n        console.log(\"Socket event callback: room_joined\");\n\n        socket.emit(\"start_call\", roomId, id);\n      });\n\n      // SOCKET EVENT CALLBACKS =====================================================\n      socket.on(\"start_call\", async (userId) => {\n        console.log(\"Socket event callback: start_call from \" + userId);\n\n        let rtcPeerConnection = new RTCPeerConnection(iceServers);\n        addLocalTracks(rtcPeerConnection);\n\n        conn[userId] = rtcPeerConnection;\n\n        rtcPeerConnection.ontrack = (event) => {\n          console.log(event);\n          setRemoteStream(event, userId);\n        };\n        rtcPeerConnection.onicecandidate = (event) => {\n          sendIceCandidate(event, userId);\n        };\n\n        await createOffer(rtcPeerConnection, userId);\n      });\n\n      socket.on(\"webrtc_offer\", async (event, userId) => {\n        console.log(\"Socket event callback: webrtc_offer from \" + userId);\n\n        let rtcPeerConnection = new RTCPeerConnection(iceServers);\n        addLocalTracks(rtcPeerConnection);\n\n        conn[userId] = rtcPeerConnection;\n\n        rtcPeerConnection.ontrack = (event) => {\n          setRemoteStream(event, userId);\n        };\n        rtcPeerConnection.onicecandidate = (event) => {\n          sendIceCandidate(event, userId);\n        };\n        rtcPeerConnection.setRemoteDescription(\n          new RTCSessionDescription(event)\n        );\n\n        await createAnswer(rtcPeerConnection, userId);\n      });\n\n      socket.on(\"webrtc_answer\", (event, userId) => {\n        console.log(\"Socket event callback: webrtc_answer from \" + userId);\n\n        console.log(conn);\n        conn[userId].setRemoteDescription(new RTCSessionDescription(event));\n      });\n\n      socket.on(\"webrtc_ice_candidate\", (event, userId) => {\n        console.log(\n          \"Socket event callback: webrtc_ice_candidate from \" + userId\n        );\n\n        // ICE candidate configuration.\n        var candidate = new RTCIceCandidate({\n          sdpMLineIndex: event.label,\n          candidate: event.candidate,\n        });\n        conn[userId].addIceCandidate(candidate);\n      });\n\n      socket.on(\"user-disconnected\", (userId) => {\n        console.log(userId + \" disconnected\");\n\n        if (conn[userId]) conn[userId].close();\n\n        const vidEl = document.getElementById(userId);\n        if (vidEl) {\n          vidEl.remove();\n          setCount((count) => count - 1);\n        }\n      });\n    });\n  }, []);\n\n  const addVideoStream = (videoGrid, video, stream, id) => {\n    video.srcObject = stream;\n    video.setAttribute(\"id\", id);\n    video.classList.add(\"video\");\n    video.addEventListener(\"loadedmetadata\", () => {\n      video.play();\n    });\n    videoGrid.append(video);\n\n    // setCount((count) => count + 1);\n  };\n\n  // FUNCTIONS ==================================================================\n  function addLocalTracks(rtcPeerConnection) {\n    localStream.getTracks().forEach((track) => {\n      rtcPeerConnection.addTrack(track, localStream);\n    });\n  }\n\n  async function createOffer(rtcPeerConnection, userId) {\n    let sessionDescription;\n    try {\n      sessionDescription = await rtcPeerConnection.createOffer();\n      rtcPeerConnection.setLocalDescription(sessionDescription);\n    } catch (error) {\n      console.error(error);\n    }\n\n    socket.emit(\n      \"webrtc_offer\",\n      {\n        type: \"webrtc_offer\",\n        sdp: sessionDescription,\n        roomId,\n      },\n      userId,\n      id\n    );\n  }\n\n  async function createAnswer(rtcPeerConnection, userId) {\n    let sessionDescription;\n    try {\n      sessionDescription = await rtcPeerConnection.createAnswer();\n      rtcPeerConnection.setLocalDescription(sessionDescription);\n    } catch (error) {\n      console.error(error);\n    }\n\n    socket.emit(\n      \"webrtc_answer\",\n      {\n        type: \"webrtc_answer\",\n        sdp: sessionDescription,\n        roomId,\n      },\n      userId,\n      id\n    );\n  }\n\n  function setRemoteStream(event, userId) {\n    console.log(event);\n    if (event.track.kind === \"video\") {\n      let video = document.createElement(\"video\");\n      addVideoStream(videoGrid, video, event.streams[0], userId);\n    }\n  }\n\n  function sendIceCandidate(event, userId) {\n    if (event.candidate) {\n      socket.emit(\n        \"webrtc_ice_candidate\",\n        {\n          roomId,\n          label: event.candidate.sdpMLineIndex,\n          candidate: event.candidate.candidate,\n        },\n        id\n      );\n    }\n  }\n\n  return (\n    <div className={classes.root}>\n      {/* <h2>MEETING</h2> */}\n      <div\n        id=\"video-grid\"\n        className={classes.grid}\n        style={{\n          gridTemplateColumns: `repeat(auto-fill, ${\n            count > 0 ? 100 / count : 100\n          }vw)`,\n          gridAutoRows: \"calc(100vh - 70px)\",\n        }}\n      ></div>\n      <div className={classes.controls}>\n        <IconButton\n          ref={micButton}\n          style={{ color: mic ? \"grey\" : \"red\", marginRight: \"10px\" }}\n        >\n          {mic ? (\n            <MicRoundedIcon style={{ fontSize: \"30px\" }} />\n          ) : (\n            <MicOffRoundedIcon style={{ fontSize: \"30px\" }} />\n          )}\n        </IconButton>\n        <IconButton\n          ref={camButton}\n          style={{ color: cam ? \"grey\" : \"red\", marginLeft: \"10px\" }}\n        >\n          {cam ? (\n            <VideocamRoundedIcon style={{ fontSize: \"30px\" }} />\n          ) : (\n            <VideocamOffRoundedIcon style={{ fontSize: \"30px\" }} />\n          )}\n        </IconButton>\n        {/* <IconButton\n          style={{ marginLeft: \"20px\", display: \"none\" }}\n          ref={flipButton}\n        >\n          <FlipCameraAndroidIcon style={{ fontSize: \"30px\" }} />\n        </IconButton> */}\n      </div>\n    </div>\n  );\n};\n\nexport default Meeting;\n","import React, { useEffect, useState } from \"react\";\n\nimport { Typography, Button } from \"@material-ui/core\";\n\nimport { useNavigate } from \"react-router-dom\";\n\nimport axios from \"axios\";\n\nconst Home = () => {\n  const navigate = useNavigate();\n\n  const [roomId, setRoomId] = useState(\"\");\n\n  useEffect(() => {\n    axios\n      .get(\"/api/call\")\n      .then((res) => {\n        console.log(res.data);\n        setRoomId(res.data);\n      })\n      .catch((err) => {\n        console.log(err.response);\n      });\n  }, []);\n\n  return (\n    <div style={{ margin: \"0px 0px 0px 30px\" }}>\n      <h1 style={{ textAlign: \"left\" }}>Video Conference App</h1>\n\n      <div style={{ display: \"flex\", alignItems: \"center\" }}>\n        <Typography>Your meeting ID</Typography>\n        <div\n          style={{\n            padding: \"10px 10px\",\n            margin: \"0px 20px\",\n            backgroundColor: \"rgb(0,0,0,0.1)\",\n          }}\n        >\n          {roomId}\n        </div>\n      </div>\n      <div style={{ display: \"flex\" }}>\n        <Button\n          variant=\"contained\"\n          style={{\n            backgroundColor: \"rgb(0, 131, 255)\",\n            color: \"white\",\n            margin: \"20px 100px\",\n          }}\n          onClick={() => {\n            navigate(`/${roomId}`);\n          }}\n        >\n          JOIN MEETING\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default Home;\n","import React from \"react\";\nimport { Navigate } from \"react-router-dom\";\n\nimport Home from \"./components/Home\";\nimport Meeting from \"./components/Meeting\";\n\nconst routes = [\n  {\n    path: \"/\",\n    // element: <Layout />,\n    children: [\n      { path: \"/\", element: <Home /> },\n      { path: \"/:roomId\", element: <Meeting /> },\n      { path: \"*\", element: <Navigate to=\"/\" replace /> },\n    ],\n  },\n];\n\nexport default routes;\n","import \"./App.css\";\nimport React from \"react\";\n\nimport routes from \"./routes\";\n\nimport { useRoutes } from \"react-router-dom\";\nimport { SnackbarProvider, useSnackbar } from \"notistack\";\n\nfunction App() {\n  const routing = useRoutes(routes);\n\n  return (\n    <div className=\"App\">\n      <SnackbarProvider maxSnack={3}>{routing}</SnackbarProvider>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nimport { BrowserRouter } from \"react-router-dom\";\n\nReactDOM.render(\n  <BrowserRouter>\n    <App />\n  </BrowserRouter>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}